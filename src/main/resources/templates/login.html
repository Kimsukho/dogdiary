<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<!-- <link rel="icon" href="/asset/favicon.ico"/> -->
	<link rel="icon" href="/favicon.png" type="image/png">
	 <!-- <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"> -->
	<title th:text="${pageTitle} ?: '๋๋์ด ์ผ์ง'">๋๋์ด ์ผ์ง</title>
	<!-- <link href="//fonts.googleapis.com/css?family=Lobster&subset=latin,latin-ext" rel="stylesheet" type="text/css"> -->
	<link rel="stylesheet" th:href="@{/css/loginStyle.css}" type="text/css">
	<script src="http://code.jquery.com/jquery-latest.js"></script> 
</head>
<body>
	<div id="container" class="container">
	    <div class="row">	      
	      <!-- ํ์๊ฐ์ -->
	      <div id="signUp" class="col align-items-center flex-col sign-up">
					<h1 style="margin-bottom: 3%; color: #4EA685">
						ํ์๊ฐ์
					</h1>
					<div class="form-wrapper align-items-center">
	          <div class="form sign-up">
	            <div class="input-group">
	              <i class='bx bxs-user'></i>
	              <input type="text" placeholder="์์ด๋">
	            </div>
	            <div class="input-group">
	              <i class='bx bx-mail-send'></i>
	              <input type="email" placeholder="์ด๋ฉ์ผ">
	            </div>
	            <div class="input-group">
	              <i class='bx bxs-lock-alt'></i>
	              <input type="password" placeholder="๋น๋ฐ๋ฒํธ">
	            </div>
	            <div class="input-group">
	              <i class='bx bxs-lock-alt'></i>
	              <input type="password" placeholder="๋น๋ฐ๋ฒํธ ์ฌํ์ธ">
	            </div>
	            <button>
	              ํ์๊ฐ์
	            </button>
	            <p>
	              <span>
	                ์ด๋ฏธ ๊ณ์์ด ์์ผ์๊ฐ์?
	              </span>
	              <b onclick="backToLogin()" class="pointer">
	                ๋ก๊ทธ์ธ
	              </b>
								<div id="toast"></div>
	            </p>
	          </div>
	        </div>
	      </div>

				<!--  ๋น๋ฐ๋ฒํธ๋ณ๊ฒฝ -->
				<div id="forgotPwd" class="col align-items-center flex-col forgot-pwd">
					<h1 style="margin-bottom: 3%; color: #4EA685">
						๋น๋ฐ๋ฒํธ ์ฌ์ค์
					</h1>
					<div class="form-wrapper align-items-center">
					<div class="form forgot-pwd">
						<div class="input-group">
							<i class='bx bxs-user'></i>
							<input type="text" placeholder="์์ด๋">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password" placeholder="ํ์ฌ ๋น๋ฐ๋ฒํธ">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password" placeholder="์ ๋น๋ฐ๋ฒํธ">
						</div>
						<div class="input-group">
							<i class='bx bxs-lock-alt'></i>
							<input type="password" placeholder="์ ๋น๋ฐ๋ฒํธ ํ์ธ">
						</div>
						<button>๋น๋ฐ๋ฒํธ ๋ณ๊ฒฝํ๊ธฐ</button>
						<p>
							<span>์ด๋ฏธ ๊ณ์์ด ์์ผ์๊ฐ์?</span>
							<b onclick="backToLogin()" class="pointer">๋ก๊ทธ์ธ</b>
						</p>
					</div>
				</div>
			</div>
		
		  <!-- ๋ก๊ทธ์ธ -->
			<div id="signIn" class="col align-items-center flex-col sign-in">
				<h1 style="margin-bottom: 3%; color: #4EA685">
					๋ก๊ทธ์ธ
				</h1> 
				<div class="form-wrapper align-items-center">
	          <div class="form sign-in">
	            <div class="input-group">
	              <i class='bx bxs-user'></i>
	              <input id="loginInputId" type="text" placeholder="์์ด๋">
	            </div>
	            <div class="input-group">
	              <i class='bx bxs-lock-alt'></i>
	              <input id="loginInputPassword" type="password" placeholder="๋น๋ฐ๋ฒํธ">
	            </div>
	            <button onclick="login()">
	              ๋ก๊ทธ์ธ
	            </button>
	            <p>
	              <b onclick="forgotPwd()" class="pointer">
	                ๋น๋ฐ๋ฒํธ๋ฅผ ์์ผ์จ๋์?
	              </b>
	            </p>
	            <p>
	              <span>
	                ๊ณ์์ด ์์ผ์๊ฐ์?
	              </span>
	              <b onclick="toggle()" class="pointer">
	                ๊ฐ์ํ๊ธฐ
	              </b>
	            </p>
	          </div>
	        </div>
	        <div class="form-wrapper">
	    
	        </div>
	      </div>
	    </div>

			<!-- ์ด๋ก์ ๋ถ๋ถ -->
	    <div class="row content-row">
	      <!-- SIGN IN CONTENT -->
	      <div class="col align-items-center flex-col">
	        <div class="text sign-in">
	          <h2>
	            Welcome!
							<br>
							Dog Diary๐ถ
	          </h2>
	  
	        </div>
	        <div class="img sign-in">
	    
	        </div>
	      </div>
	      <div class="col align-items-center flex-col">
	        <div class="img sign-up">
	        
	        </div>
	        <div class="text sign-up">
	          <h2>
	            Join with us๐บ
	          </h2>
	  
	        </div>
	      </div>

				<div class="col align-items-center flex-col">
					<div class="img forgot-pwd">
						<!-- ๋น๋ฐ๋ฒํธ ์ฌ์ค์ ๊ด๋จ ์ด๋ฏธ์ง (์ํ์ฌํญ) -->
					</div>
					<div class="text forgot-pwd">
						<h2>
							Reset your <br>
							password ๐
						</h2>
						<p>
							์ ๋น๋ฐ๋ฒํธ๋ฅผ ์๋ฅํ๊ณ ๊ณ์์ ์์ํ๊ฒ ์งํค์ธ์.
						</p>
					</div>
				</div>

	    </div>
	    
    	<script>
		  let container = document.getElementById('container');
		
			function toggle() {
				container.classList.remove('forgot-pwd'); // ๋น๋ฒ์ฌ์ค์ ๋ชจ๋ ํด์
				container.classList.toggle('sign-in');
				container.classList.toggle('sign-up');
			}

			function forgotPwd() {
				container.classList.remove('sign-in');
				container.classList.remove('sign-up');
				container.classList.add('forgot-pwd');
			}

			function backToLogin() {
				container.classList.remove('sign-up');
				container.classList.remove('forgot-pwd');
				container.classList.add('sign-in');
			}

			let removeToast;

			function toast(string) {
					const toast = document.getElementById("toast");

					toast.classList.contains("reveal") ?
							(clearTimeout(removeToast), removeToast = setTimeout(function () {
									document.getElementById("toast").classList.remove("reveal")
							}, 1000)) :
							removeToast = setTimeout(function () {
									document.getElementById("toast").classList.remove("reveal")
							}, 1000)
					toast.classList.add("reveal"),
							toast.innerText = string
			}

			function login() {
				let loginId = document.getElementById("loginInputId").value;
				let password = document.getElementById("loginInputPassword").value;
				
				if(!loginId || !password) {
					toast('์์ด๋์ ๋น๋ฐ๋ฒํธ๋ฅผ ์๋ฅํด์ฃผ์ธ์.');
					return;
				}

				$.ajax({
					url: '/api/public/authenticate',
					method: 'POST',
					headers: {
						'Content-Type': 'application/json'
					},
					data: JSON.stringify({ username: loginId, password: password }),
					success: function(data, textStatus, jqXHR) {
						console.log('๋ก๊ทธ์ธ ์ฑ๊ณต:', data);
						// ๋ก๊ทธ์ธ ์ฑ๊ณต ์ ๋์๋ณด๋๋ก ๋ฆฌ๋ค์ด๋ํธ
						window.location.href = '/dashboard';
					},
					error: function(xhr, status, error) {
						console.error('๋ก๊ทธ์ธ ์คํจ:', error);
						let errorMessage = '๋ก๊ทธ์ธ์ ์คํจํ์ต๋๋ค. ์์ด๋์ ๋น๋ฐ๋ฒํธ๋ฅผ ํ์ธํด์ฃผ์ธ์.';
						
						if(xhr.responseJSON && xhr.responseJSON.message) {
							errorMessage = xhr.responseJSON.message;
						}
						
						toast(errorMessage);
					}
				});
			}

			function logout() {
				// Spring Security์ logout ์๋ํฌ์ธํธ ์ฌ์ฉ
				window.location.href = '/logout';
			}
		
		  // ์ด๊ธฐ ์ํ: ๋ก๊ทธ์ธ ํ๋ฉด
		  setTimeout(() => {
		    container.classList.add('sign-in');
		  }, 200);
		</script>

  </div>
</body>
</html>